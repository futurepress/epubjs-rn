(function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t(require('xmldom')):'function'==typeof define&&define.amd?define(['xmldom'],t):'object'==typeof exports?exports.EPUBJSContents=t(require('xmldom')):e.EPUBJSContents=t(e.xmldom)})(window,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&'object'==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,'default',{enumerable:!0,value:e}),2&r&&'string'!=typeof e)for(var i in e)t.d(n,i,function(t){return e[t]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(r,'a',r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p='',t(t.s='./contents/contents.js')}({"./contents/contents.js":function(e,t,r){'use strict';eval('var Contents=__webpack_require__(/*! epubjs/lib/contents */ "./node_modules/epubjs/lib/contents.js");module.exports=Contents;\n\n//# sourceURL=webpack://EPUBJSContents/./contents/contents.js?')},"./node_modules/d/index.js":function(e,t,r){'use strict';eval('var assign=__webpack_require__(/*! es5-ext/object/assign */ "./node_modules/es5-ext/object/assign/index.js"),normalizeOpts=__webpack_require__(/*! es5-ext/object/normalize-options */ "./node_modules/es5-ext/object/normalize-options.js"),isCallable=__webpack_require__(/*! es5-ext/object/is-callable */ "./node_modules/es5-ext/object/is-callable.js"),contains=__webpack_require__(/*! es5-ext/string/#/contains */ "./node_modules/es5-ext/string/#/contains/index.js"),d;d=module.exports=function(dscr,value){var c,e,w,options,desc;if(arguments.length<2||typeof dscr!==\'string\'){options=value;value=dscr;dscr=null;}else{options=arguments[2];}if(dscr==null){c=w=true;e=false;}else{c=contains.call(dscr,\'c\');e=contains.call(dscr,\'e\');w=contains.call(dscr,\'w\');}desc={value:value,configurable:c,enumerable:e,writable:w};return!options?desc:assign(normalizeOpts(options),desc);};d.gs=function(dscr,get,set){var c,e,options,desc;if(typeof dscr!==\'string\'){options=set;set=get;get=dscr;dscr=null;}else{options=arguments[3];}if(get==null){get=undefined;}else if(!isCallable(get)){options=get;get=set=undefined;}else if(set==null){set=undefined;}else if(!isCallable(set)){options=set;set=undefined;}if(dscr==null){c=true;e=false;}else{c=contains.call(dscr,\'c\');e=contains.call(dscr,\'e\');}desc={get:get,set:set,configurable:c,enumerable:e};return!options?desc:assign(normalizeOpts(options),desc);};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/d/index.js?')},"./node_modules/epubjs/lib/contents.js":function(e,t,r){'use strict';eval('Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _eventEmitter=__webpack_require__(/*! event-emitter */ "./node_modules/event-emitter/index.js");var _eventEmitter2=_interopRequireDefault(_eventEmitter);var _core=__webpack_require__(/*! ./utils/core */ "./node_modules/epubjs/lib/utils/core.js");var _epubcfi=__webpack_require__(/*! ./epubcfi */ "./node_modules/epubjs/lib/epubcfi.js");var _epubcfi2=_interopRequireDefault(_epubcfi);var _mapping=__webpack_require__(/*! ./mapping */ "./node_modules/epubjs/lib/mapping.js");var _mapping2=_interopRequireDefault(_mapping);var _replacements=__webpack_require__(/*! ./utils/replacements */ "./node_modules/epubjs/lib/utils/replacements.js");var _constants=__webpack_require__(/*! ./utils/constants */ "./node_modules/epubjs/lib/utils/constants.js");function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var hasNavigator=typeof navigator!=="undefined";var isChrome=hasNavigator&&/Chrome/.test(navigator.userAgent);var isWebkit=hasNavigator&&!isChrome&&/AppleWebKit/.test(navigator.userAgent);var ELEMENT_NODE=1;var TEXT_NODE=3;var Contents=function(){function Contents(doc,content,cfiBase,sectionIndex){_classCallCheck(this,Contents);this.epubcfi=new _epubcfi2.default();this.document=doc;this.documentElement=this.document.documentElement;this.content=content||this.document.body;this.window=this.document.defaultView;this._size={width:0,height:0};this.sectionIndex=sectionIndex||0;this.cfiBase=cfiBase||"";this.epubReadingSystem("epub.js",ePub.VERSION);this.listeners();}_createClass(Contents,[{key:"width",value:function width(w){var frame=this.content;if(w&&(0,_core.isNumber)(w)){w=w+"px";}if(w){frame.style.width=w;}return this.window.getComputedStyle(frame)["width"];}},{key:"height",value:function height(h){var frame=this.content;if(h&&(0,_core.isNumber)(h)){h=h+"px";}if(h){frame.style.height=h;}return this.window.getComputedStyle(frame)["height"];}},{key:"contentWidth",value:function contentWidth(w){var content=this.content||this.document.body;if(w&&(0,_core.isNumber)(w)){w=w+"px";}if(w){content.style.width=w;}return this.window.getComputedStyle(content)["width"];}},{key:"contentHeight",value:function contentHeight(h){var content=this.content||this.document.body;if(h&&(0,_core.isNumber)(h)){h=h+"px";}if(h){content.style.height=h;}return this.window.getComputedStyle(content)["height"];}},{key:"textWidth",value:function textWidth(){var width=void 0;var range=this.document.createRange();var content=this.content||this.document.body;var border=(0,_core.borders)(content);range.selectNodeContents(content);width=range.getBoundingClientRect().width;if(border&&border.width){width+=border.width;}return Math.round(width);}},{key:"textHeight",value:function textHeight(){var height=void 0;var range=this.document.createRange();var content=this.content||this.document.body;var border=(0,_core.borders)(content);range.selectNodeContents(content);height=range.getBoundingClientRect().height;if(height&&border.height){height+=border.height;}return Math.round(height);}},{key:"scrollWidth",value:function scrollWidth(){var width=this.documentElement.scrollWidth;return width;}},{key:"scrollHeight",value:function scrollHeight(){var height=this.documentElement.scrollHeight;return height;}},{key:"overflow",value:function overflow(_overflow){if(_overflow){this.documentElement.style.overflow=_overflow;}return this.window.getComputedStyle(this.documentElement)["overflow"];}},{key:"overflowX",value:function overflowX(overflow){if(overflow){this.documentElement.style.overflowX=overflow;}return this.window.getComputedStyle(this.documentElement)["overflowX"];}},{key:"overflowY",value:function overflowY(overflow){if(overflow){this.documentElement.style.overflowY=overflow;}return this.window.getComputedStyle(this.documentElement)["overflowY"];}},{key:"css",value:function css(property,value,priority){var content=this.content||this.document.body;if(value){content.style.setProperty(property,value,priority?"important":"");}return this.window.getComputedStyle(content)[property];}},{key:"viewport",value:function viewport(options){var _width,_height,_scale,_minimum,_maximum,_scalable;var $viewport=this.document.querySelector("meta[name=\'viewport\']");var parsed={"width":undefined,"height":undefined,"scale":undefined,"minimum":undefined,"maximum":undefined,"scalable":undefined};var newContent=[];var settings={};if($viewport&&$viewport.hasAttribute("content")){var content=$viewport.getAttribute("content");var _width2=content.match(/width\\s*=\\s*([^,]*)/);var _height2=content.match(/height\\s*=\\s*([^,]*)/);var _scale2=content.match(/initial-scale\\s*=\\s*([^,]*)/);var _minimum2=content.match(/minimum-scale\\s*=\\s*([^,]*)/);var _maximum2=content.match(/maximum-scale\\s*=\\s*([^,]*)/);var _scalable2=content.match(/user-scalable\\s*=\\s*([^,]*)/);if(_width2&&_width2.length&&typeof _width2[1]!=="undefined"){parsed.width=_width2[1];}if(_height2&&_height2.length&&typeof _height2[1]!=="undefined"){parsed.height=_height2[1];}if(_scale2&&_scale2.length&&typeof _scale2[1]!=="undefined"){parsed.scale=_scale2[1];}if(_minimum2&&_minimum2.length&&typeof _minimum2[1]!=="undefined"){parsed.minimum=_minimum2[1];}if(_maximum2&&_maximum2.length&&typeof _maximum2[1]!=="undefined"){parsed.maximum=_maximum2[1];}if(_scalable2&&_scalable2.length&&typeof _scalable2[1]!=="undefined"){parsed.scalable=_scalable2[1];}}settings=(0,_core.defaults)(options||{},parsed);if(options){if(settings.width){newContent.push("width="+settings.width);}if(settings.height){newContent.push("height="+settings.height);}if(settings.scale){newContent.push("initial-scale="+settings.scale);}if(settings.scalable==="no"){newContent.push("minimum-scale="+settings.scale);newContent.push("maximum-scale="+settings.scale);newContent.push("user-scalable="+settings.scalable);}else{if(settings.scalable){newContent.push("user-scalable="+settings.scalable);}if(settings.minimum){newContent.push("minimum-scale="+settings.minimum);}if(settings.maximum){newContent.push("minimum-scale="+settings.maximum);}}if(!$viewport){$viewport=this.document.createElement("meta");$viewport.setAttribute("name","viewport");this.document.querySelector("head").appendChild($viewport);}$viewport.setAttribute("content",newContent.join(", "));this.window.scrollTo(0,0);}return settings;}},{key:"expand",value:function expand(){this.emit(_constants.EVENTS.CONTENTS.EXPAND);}},{key:"listeners",value:function listeners(){this.imageLoadListeners();this.mediaQueryListeners();this.addEventListeners();this.addSelectionListeners();this.resizeListeners();this.linksHandler();}},{key:"removeListeners",value:function removeListeners(){this.removeEventListeners();this.removeSelectionListeners();clearTimeout(this.expanding);}},{key:"resizeCheck",value:function resizeCheck(){var width=this.textWidth();var height=this.textHeight();if(width!=this._size.width||height!=this._size.height){this._size={width:width,height:height};this.onResize&&this.onResize(this._size);this.emit(_constants.EVENTS.CONTENTS.RESIZE,this._size);}}},{key:"resizeListeners",value:function resizeListeners(){var width,height;clearTimeout(this.expanding);requestAnimationFrame(this.resizeCheck.bind(this));this.expanding=setTimeout(this.resizeListeners.bind(this),350);}},{key:"transitionListeners",value:function transitionListeners(){var body=this.content;body.style[\'transitionProperty\']="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height";body.style[\'transitionDuration\']="0.001ms";body.style[\'transitionTimingFunction\']="linear";body.style[\'transitionDelay\']="0";this.document.addEventListener(\'transitionend\',this.resizeCheck.bind(this));}},{key:"mediaQueryListeners",value:function mediaQueryListeners(){var sheets=this.document.styleSheets;var mediaChangeHandler=function(m){if(m.matches&&!this._expanding){setTimeout(this.expand.bind(this),1);}}.bind(this);for(var i=0;i<sheets.length;i+=1){var rules;try{rules=sheets[i].cssRules;}catch(e){return;}if(!rules)return;for(var j=0;j<rules.length;j+=1){if(rules[j].media){var mql=this.window.matchMedia(rules[j].media.mediaText);mql.addListener(mediaChangeHandler);}}}}},{key:"resizeObservers",value:function resizeObservers(){var _this=this;this.observer=new MutationObserver(function(mutations){_this.resizeCheck();});var config={attributes:true,childList:true,characterData:true,subtree:true};this.observer.observe(this.document,config);}},{key:"imageLoadListeners",value:function imageLoadListeners(target){var images=this.document.querySelectorAll("img");var img;for(var i=0;i<images.length;i++){img=images[i];if(typeof img.naturalWidth!=="undefined"&&img.naturalWidth===0){img.onload=this.expand.bind(this);}}}},{key:"fontLoadListeners",value:function fontLoadListeners(target){if(!this.document||!this.document.fonts){return;}this.document.fonts.ready.then(function(){this.resizeCheck();}.bind(this));}},{key:"root",value:function root(){if(!this.document)return null;return this.document.documentElement;}},{key:"locationOf",value:function locationOf(target,ignoreClass){var position;var targetPos={"left":0,"top":0};if(!this.document)return targetPos;if(this.epubcfi.isCfiString(target)){var range=new _epubcfi2.default(target).toRange(this.document,ignoreClass);if(range){if(range.startContainer.nodeType===Node.ELEMENT_NODE){position=range.startContainer.getBoundingClientRect();targetPos.left=position.left;targetPos.top=position.top;}else{if(isWebkit){var container=range.startContainer;var newRange=new Range();try{if(container.nodeType===ELEMENT_NODE){position=container.getBoundingClientRect();}else if(range.startOffset+2<container.length){newRange.setStart(container,range.startOffset);newRange.setEnd(container,range.startOffset+2);position=newRange.getBoundingClientRect();}else if(range.startOffset-2>0){newRange.setStart(container,range.startOffset-2);newRange.setEnd(container,range.startOffset);position=newRange.getBoundingClientRect();}else{position=container.parentNode.getBoundingClientRect();}}catch(e){console.error(e,e.stack);}}else{position=range.getBoundingClientRect();}}}}else if(typeof target==="string"&&target.indexOf("#")>-1){var id=target.substring(target.indexOf("#")+1);var el=this.document.getElementById(id);if(el){position=el.getBoundingClientRect();}}if(position){targetPos.left=position.left;targetPos.top=position.top;}return targetPos;}},{key:"addStylesheet",value:function addStylesheet(src){return new Promise(function(resolve,reject){var $stylesheet;var ready=false;if(!this.document){resolve(false);return;}$stylesheet=this.document.querySelector("link[href=\'"+src+"\']");if($stylesheet){resolve(true);return;}$stylesheet=this.document.createElement("link");$stylesheet.type="text/css";$stylesheet.rel="stylesheet";$stylesheet.href=src;$stylesheet.onload=$stylesheet.onreadystatechange=function(){if(!ready&&(!this.readyState||this.readyState=="complete")){ready=true;setTimeout(function(){resolve(true);},1);}};this.document.head.appendChild($stylesheet);}.bind(this));}},{key:"addStylesheetRules",value:function addStylesheetRules(rules){var styleEl;var styleSheet;var key="epubjs-inserted-css";if(!this.document||!rules||rules.length===0)return;styleEl=this.document.getElementById("#"+key);if(!styleEl){styleEl=this.document.createElement("style");styleEl.id=key;}this.document.head.appendChild(styleEl);styleSheet=styleEl.sheet;if(Object.prototype.toString.call(rules)==="[object Array]"){for(var i=0,rl=rules.length;i<rl;i++){var j=1,rule=rules[i],selector=rules[i][0],propStr="";if(Object.prototype.toString.call(rule[1][0])==="[object Array]"){rule=rule[1];j=0;}for(var pl=rule.length;j<pl;j++){var prop=rule[j];propStr+=prop[0]+":"+prop[1]+(prop[2]?" !important":"")+";\\n";}styleSheet.insertRule(selector+"{"+propStr+"}",styleSheet.cssRules.length);}}else{var selectors=Object.keys(rules);selectors.forEach(function(selector){var definition=rules[selector];if(Array.isArray(definition)){definition.forEach(function(item){var _rules=Object.keys(item);var result=_rules.map(function(rule){return rule+":"+item[rule];}).join(\';\');styleSheet.insertRule(selector+"{"+result+"}",styleSheet.cssRules.length);});}else{var _rules=Object.keys(definition);var result=_rules.map(function(rule){return rule+":"+definition[rule];}).join(\';\');styleSheet.insertRule(selector+"{"+result+"}",styleSheet.cssRules.length);}});}}},{key:"addScript",value:function addScript(src){return new Promise(function(resolve,reject){var $script;var ready=false;if(!this.document){resolve(false);return;}$script=this.document.createElement("script");$script.type="text/javascript";$script.async=true;$script.src=src;$script.onload=$script.onreadystatechange=function(){if(!ready&&(!this.readyState||this.readyState=="complete")){ready=true;setTimeout(function(){resolve(true);},1);}};this.document.head.appendChild($script);}.bind(this));}},{key:"addClass",value:function addClass(className){var content;if(!this.document)return;content=this.content||this.document.body;if(content){content.classList.add(className);}}},{key:"removeClass",value:function removeClass(className){var content;if(!this.document)return;content=this.content||this.document.body;if(content){content.classList.remove(className);}}},{key:"addEventListeners",value:function addEventListeners(){if(!this.document){return;}_constants.DOM_EVENTS.forEach(function(eventName){this.document.addEventListener(eventName,this.triggerEvent.bind(this),false);},this);}},{key:"removeEventListeners",value:function removeEventListeners(){if(!this.document){return;}_constants.DOM_EVENTS.forEach(function(eventName){this.document.removeEventListener(eventName,this.triggerEvent,false);},this);}},{key:"triggerEvent",value:function triggerEvent(e){this.emit(e.type,e);}},{key:"addSelectionListeners",value:function addSelectionListeners(){if(!this.document){return;}this.document.addEventListener("selectionchange",this.onSelectionChange.bind(this),false);}},{key:"removeSelectionListeners",value:function removeSelectionListeners(){if(!this.document){return;}this.document.removeEventListener("selectionchange",this.onSelectionChange,false);}},{key:"onSelectionChange",value:function onSelectionChange(e){if(this.selectionEndTimeout){clearTimeout(this.selectionEndTimeout);}this.selectionEndTimeout=setTimeout(function(){var selection=this.window.getSelection();this.triggerSelectedEvent(selection);}.bind(this),250);}},{key:"triggerSelectedEvent",value:function triggerSelectedEvent(selection){var range,cfirange;if(selection&&selection.rangeCount>0){range=selection.getRangeAt(0);if(!range.collapsed){cfirange=new _epubcfi2.default(range,this.cfiBase).toString();this.emit(_constants.EVENTS.CONTENTS.SELECTED,cfirange);this.emit(_constants.EVENTS.CONTENTS.SELECTED_RANGE,range);}}}},{key:"range",value:function range(_cfi,ignoreClass){var cfi=new _epubcfi2.default(_cfi);return cfi.toRange(this.document,ignoreClass);}},{key:"cfiFromRange",value:function cfiFromRange(range,ignoreClass){return new _epubcfi2.default(range,this.cfiBase,ignoreClass).toString();}},{key:"cfiFromNode",value:function cfiFromNode(node,ignoreClass){return new _epubcfi2.default(node,this.cfiBase,ignoreClass).toString();}},{key:"map",value:function map(layout){var map=new _mapping2.default(layout);return map.section();}},{key:"size",value:function size(width,height){var viewport={scale:1.0,scalable:"no"};this.layoutStyle("scrolling");if(width>=0){this.width(width);viewport.width=width;this.css("padding","0 "+width/12+"px");}if(height>=0){this.height(height);viewport.height=height;}this.css("margin","0");this.css("box-sizing","border-box");this.viewport(viewport);}},{key:"columns",value:function columns(width,height,columnWidth,gap){var COLUMN_AXIS=(0,_core.prefixed)("column-axis");var COLUMN_GAP=(0,_core.prefixed)("column-gap");var COLUMN_WIDTH=(0,_core.prefixed)("column-width");var COLUMN_FILL=(0,_core.prefixed)("column-fill");var writingMode=this.writingMode();var axis=writingMode.indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated");if(this.content.dir==="rtl"){this.direction("rtl");}this.width(width);this.height(height);this.viewport({width:width,height:height,scale:1.0,scalable:"no"});this.css("overflow-y","hidden");this.css("margin","0",true);if(axis==="vertical"){this.css("padding-top",gap/2+"px",true);this.css("padding-bottom",gap/2+"px",true);this.css("padding-left","20px");this.css("padding-right","20px");}else{this.css("padding-top","20px");this.css("padding-bottom","20px");this.css("padding-left",gap/2+"px",true);this.css("padding-right",gap/2+"px",true);}this.css("box-sizing","border-box");this.css("max-width","inherit");this.css(COLUMN_AXIS,"horizontal");this.css(COLUMN_FILL,"auto");this.css(COLUMN_GAP,gap+"px");this.css(COLUMN_WIDTH,columnWidth+"px");}},{key:"scaler",value:function scaler(scale,offsetX,offsetY){var scaleStr="scale("+scale+")";var translateStr="";this.css("transform-origin","top left");if(offsetX>=0||offsetY>=0){translateStr=" translate("+(offsetX||0)+"px, "+(offsetY||0)+"px )";}this.css("transform",scaleStr+translateStr);}},{key:"fit",value:function fit(width,height){var viewport=this.viewport();var widthScale=width/parseInt(viewport.width);var heightScale=height/parseInt(viewport.height);var scale=widthScale<heightScale?widthScale:heightScale;var offsetY=(height-viewport.height*scale)/2;this.layoutStyle("paginated");this.width(width);this.height(height);this.overflow("hidden");this.scaler(scale,0,offsetY);this.css("background-color","transparent");}},{key:"direction",value:function direction(dir){if(this.documentElement){this.documentElement.style["direction"]=dir;}}},{key:"mapPage",value:function mapPage(cfiBase,layout,start,end,dev){var mapping=new _mapping2.default(layout,dev);return mapping.page(this,cfiBase,start,end);}},{key:"linksHandler",value:function linksHandler(){var _this2=this;(0,_replacements.replaceLinks)(this.content,function(href){_this2.emit(_constants.EVENTS.CONTENTS.LINK_CLICKED,href);});}},{key:"writingMode",value:function writingMode(mode){var WRITING_MODE=(0,_core.prefixed)("writing-mode");if(mode&&this.documentElement){this.documentElement.style[WRITING_MODE]=mode;}return this.window.getComputedStyle(this.documentElement)[WRITING_MODE]||\'\';}},{key:"layoutStyle",value:function layoutStyle(style){if(style){this._layoutStyle=style;navigator.epubReadingSystem.layoutStyle=this._layoutStyle;}return this._layoutStyle||"paginated";}},{key:"epubReadingSystem",value:function epubReadingSystem(name,version){navigator.epubReadingSystem={name:name,version:version,layoutStyle:this.layoutStyle(),hasFeature:function hasFeature(feature){switch(feature){case"dom-manipulation":return true;case"layout-changes":return true;case"touch-events":return true;case"mouse-events":return true;case"keyboard-events":return true;case"spine-scripting":return false;default:return false;}}};return navigator.epubReadingSystem;}},{key:"destroy",value:function destroy(){if(this.observer){this.observer.disconnect();}this.document.removeEventListener(\'transitionend\',this.resizeCheck);this.removeListeners();}}],[{key:"listenedEvents",get:function get(){return _constants.DOM_EVENTS;}}]);return Contents;}();(0,_eventEmitter2.default)(Contents.prototype);exports.default=Contents;module.exports=exports["default"];\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/epubjs/lib/contents.js?')},"./node_modules/epubjs/lib/epubcfi.js":function(e,t,r){'use strict';eval('var _typeof2=typeof Symbol==="function"&&typeof(typeof Symbol==="function"?Symbol.iterator:"@@iterator")==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==(typeof Symbol==="function"?Symbol.prototype:"@@prototype")?"symbol":typeof obj;};Object.defineProperty(exports,"__esModule",{value:true});var _typeof=typeof Symbol==="function"&&_typeof2(typeof Symbol==="function"?Symbol.iterator:"@@iterator")==="symbol"?function(obj){return typeof obj==="undefined"?"undefined":_typeof2(obj);}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==(typeof Symbol==="function"?Symbol.prototype:"@@prototype")?"symbol":typeof obj==="undefined"?"undefined":_typeof2(obj);};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _core=__webpack_require__(/*! ./utils/core */ "./node_modules/epubjs/lib/utils/core.js");function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var ELEMENT_NODE=1;var TEXT_NODE=3;var COMMENT_NODE=8;var DOCUMENT_NODE=9;var EpubCFI=function(){function EpubCFI(cfiFrom,base,ignoreClass){_classCallCheck(this,EpubCFI);var type;this.str="";this.base={};this.spinePos=0;this.range=false;this.path={};this.start=null;this.end=null;if(!(this instanceof EpubCFI)){return new EpubCFI(cfiFrom,base,ignoreClass);}if(typeof base==="string"){this.base=this.parseComponent(base);}else if((typeof base==="undefined"?"undefined":_typeof(base))==="object"&&base.steps){this.base=base;}type=this.checkType(cfiFrom);if(type==="string"){this.str=cfiFrom;return(0,_core.extend)(this,this.parse(cfiFrom));}else if(type==="range"){return(0,_core.extend)(this,this.fromRange(cfiFrom,this.base,ignoreClass));}else if(type==="node"){return(0,_core.extend)(this,this.fromNode(cfiFrom,this.base,ignoreClass));}else if(type==="EpubCFI"&&cfiFrom.path){return cfiFrom;}else if(!cfiFrom){return this;}else{throw new TypeError("not a valid argument for EpubCFI");}}_createClass(EpubCFI,[{key:"checkType",value:function checkType(cfi){if(this.isCfiString(cfi)){return"string";}else if((typeof cfi==="undefined"?"undefined":_typeof(cfi))==="object"&&((0,_core.type)(cfi)==="Range"||typeof cfi.startContainer!="undefined")){return"range";}else if((typeof cfi==="undefined"?"undefined":_typeof(cfi))==="object"&&typeof cfi.nodeType!="undefined"){return"node";}else if((typeof cfi==="undefined"?"undefined":_typeof(cfi))==="object"&&cfi instanceof EpubCFI){return"EpubCFI";}else{return false;}}},{key:"parse",value:function parse(cfiStr){var cfi={spinePos:-1,range:false,base:{},path:{},start:null,end:null};var baseComponent,pathComponent,range;if(typeof cfiStr!=="string"){return{spinePos:-1};}if(cfiStr.indexOf("epubcfi(")===0&&cfiStr[cfiStr.length-1]===")"){cfiStr=cfiStr.slice(8,cfiStr.length-1);}baseComponent=this.getChapterComponent(cfiStr);if(!baseComponent){return{spinePos:-1};}cfi.base=this.parseComponent(baseComponent);pathComponent=this.getPathComponent(cfiStr);cfi.path=this.parseComponent(pathComponent);range=this.getRange(cfiStr);if(range){cfi.range=true;cfi.start=this.parseComponent(range[0]);cfi.end=this.parseComponent(range[1]);}cfi.spinePos=cfi.base.steps[1].index;return cfi;}},{key:"parseComponent",value:function parseComponent(componentStr){var component={steps:[],terminal:{offset:null,assertion:null}};var parts=componentStr.split(":");var steps=parts[0].split("/");var terminal;if(parts.length>1){terminal=parts[1];component.terminal=this.parseTerminal(terminal);}if(steps[0]===""){steps.shift();}component.steps=steps.map(function(step){return this.parseStep(step);}.bind(this));return component;}},{key:"parseStep",value:function parseStep(stepStr){var type,num,index,has_brackets,id;has_brackets=stepStr.match(/\\[(.*)\\]/);if(has_brackets&&has_brackets[1]){id=has_brackets[1];}num=parseInt(stepStr);if(isNaN(num)){return;}if(num%2===0){type="element";index=num/2-1;}else{type="text";index=(num-1)/2;}return{"type":type,"index":index,"id":id||null};}},{key:"parseTerminal",value:function parseTerminal(termialStr){var characterOffset,textLocationAssertion;var assertion=termialStr.match(/\\[(.*)\\]/);if(assertion&&assertion[1]){characterOffset=parseInt(termialStr.split("[")[0]);textLocationAssertion=assertion[1];}else{characterOffset=parseInt(termialStr);}if(!(0,_core.isNumber)(characterOffset)){characterOffset=null;}return{"offset":characterOffset,"assertion":textLocationAssertion};}},{key:"getChapterComponent",value:function getChapterComponent(cfiStr){var indirection=cfiStr.split("!");return indirection[0];}},{key:"getPathComponent",value:function getPathComponent(cfiStr){var indirection=cfiStr.split("!");if(indirection[1]){var ranges=indirection[1].split(",");return ranges[0];}}},{key:"getRange",value:function getRange(cfiStr){var ranges=cfiStr.split(",");if(ranges.length===3){return[ranges[1],ranges[2]];}return false;}},{key:"getCharecterOffsetComponent",value:function getCharecterOffsetComponent(cfiStr){var splitStr=cfiStr.split(":");return splitStr[1]||"";}},{key:"joinSteps",value:function joinSteps(steps){if(!steps){return"";}return steps.map(function(part){var segment="";if(part.type==="element"){segment+=(part.index+1)*2;}if(part.type==="text"){segment+=1+2*part.index;}if(part.id){segment+="["+part.id+"]";}return segment;}).join("/");}},{key:"segmentString",value:function segmentString(segment){var segmentString="/";segmentString+=this.joinSteps(segment.steps);if(segment.terminal&&segment.terminal.offset!=null){segmentString+=":"+segment.terminal.offset;}if(segment.terminal&&segment.terminal.assertion!=null){segmentString+="["+segment.terminal.assertion+"]";}return segmentString;}},{key:"toString",value:function toString(){var cfiString="epubcfi(";cfiString+=this.segmentString(this.base);cfiString+="!";cfiString+=this.segmentString(this.path);if(this.range&&this.start){cfiString+=",";cfiString+=this.segmentString(this.start);}if(this.range&&this.end){cfiString+=",";cfiString+=this.segmentString(this.end);}cfiString+=")";return cfiString;}},{key:"compare",value:function compare(cfiOne,cfiTwo){var stepsA,stepsB;var terminalA,terminalB;var rangeAStartSteps,rangeAEndSteps;var rangeBEndSteps,rangeBEndSteps;var rangeAStartTerminal,rangeAEndTerminal;var rangeBStartTerminal,rangeBEndTerminal;if(typeof cfiOne==="string"){cfiOne=new EpubCFI(cfiOne);}if(typeof cfiTwo==="string"){cfiTwo=new EpubCFI(cfiTwo);}if(cfiOne.spinePos>cfiTwo.spinePos){return 1;}if(cfiOne.spinePos<cfiTwo.spinePos){return-1;}if(cfiOne.range){stepsA=cfiOne.path.steps.concat(cfiOne.start.steps);terminalA=cfiOne.start.terminal;}else{stepsA=cfiOne.path.steps;terminalA=cfiOne.path.terminal;}if(cfiTwo.range){stepsB=cfiTwo.path.steps.concat(cfiTwo.start.steps);terminalB=cfiTwo.start.terminal;}else{stepsB=cfiTwo.path.steps;terminalB=cfiTwo.path.terminal;}for(var i=0;i<stepsA.length;i++){if(!stepsA[i]){return-1;}if(!stepsB[i]){return 1;}if(stepsA[i].index>stepsB[i].index){return 1;}if(stepsA[i].index<stepsB[i].index){return-1;}}if(stepsA.length<stepsB.length){return 1;}if(terminalA.offset>terminalB.offset){return 1;}if(terminalA.offset<terminalB.offset){return-1;}return 0;}},{key:"step",value:function step(node){var nodeType=node.nodeType===TEXT_NODE?"text":"element";return{"id":node.id,"tagName":node.tagName,"type":nodeType,"index":this.position(node)};}},{key:"filteredStep",value:function filteredStep(node,ignoreClass){var filteredNode=this.filter(node,ignoreClass);var nodeType;if(!filteredNode){return;}nodeType=filteredNode.nodeType===TEXT_NODE?"text":"element";return{"id":filteredNode.id,"tagName":filteredNode.tagName,"type":nodeType,"index":this.filteredPosition(filteredNode,ignoreClass)};}},{key:"pathTo",value:function pathTo(node,offset,ignoreClass){var segment={steps:[],terminal:{offset:null,assertion:null}};var currentNode=node;var step;while(currentNode&&currentNode.parentNode&&currentNode.parentNode.nodeType!=DOCUMENT_NODE){if(ignoreClass){step=this.filteredStep(currentNode,ignoreClass);}else{step=this.step(currentNode);}if(step){segment.steps.unshift(step);}currentNode=currentNode.parentNode;}if(offset!=null&&offset>=0){segment.terminal.offset=offset;if(segment.steps[segment.steps.length-1].type!="text"){segment.steps.push({"type":"text","index":0});}}return segment;}},{key:"equalStep",value:function equalStep(stepA,stepB){if(!stepA||!stepB){return false;}if(stepA.index===stepB.index&&stepA.id===stepB.id&&stepA.type===stepB.type){return true;}return false;}},{key:"fromRange",value:function fromRange(range,base,ignoreClass){var cfi={range:false,base:{},path:{},start:null,end:null};var start=range.startContainer;var end=range.endContainer;var startOffset=range.startOffset;var endOffset=range.endOffset;var needsIgnoring=false;if(ignoreClass){needsIgnoring=start.ownerDocument.querySelector("."+ignoreClass)!=null;}if(typeof base==="string"){cfi.base=this.parseComponent(base);cfi.spinePos=cfi.base.steps[1].index;}else if((typeof base==="undefined"?"undefined":_typeof(base))==="object"){cfi.base=base;}if(range.collapsed){if(needsIgnoring){startOffset=this.patchOffset(start,startOffset,ignoreClass);}cfi.path=this.pathTo(start,startOffset,ignoreClass);}else{cfi.range=true;if(needsIgnoring){startOffset=this.patchOffset(start,startOffset,ignoreClass);}cfi.start=this.pathTo(start,startOffset,ignoreClass);if(needsIgnoring){endOffset=this.patchOffset(end,endOffset,ignoreClass);}cfi.end=this.pathTo(end,endOffset,ignoreClass);cfi.path={steps:[],terminal:null};var len=cfi.start.steps.length;var i;for(i=0;i<len;i++){if(this.equalStep(cfi.start.steps[i],cfi.end.steps[i])){if(i===len-1){if(cfi.start.terminal===cfi.end.terminal){cfi.path.steps.push(cfi.start.steps[i]);cfi.range=false;}}else{cfi.path.steps.push(cfi.start.steps[i]);}}else{break;}}cfi.start.steps=cfi.start.steps.slice(cfi.path.steps.length);cfi.end.steps=cfi.end.steps.slice(cfi.path.steps.length);}return cfi;}},{key:"fromNode",value:function fromNode(anchor,base,ignoreClass){var cfi={range:false,base:{},path:{},start:null,end:null};if(typeof base==="string"){cfi.base=this.parseComponent(base);cfi.spinePos=cfi.base.steps[1].index;}else if((typeof base==="undefined"?"undefined":_typeof(base))==="object"){cfi.base=base;}cfi.path=this.pathTo(anchor,null,ignoreClass);return cfi;}},{key:"filter",value:function filter(anchor,ignoreClass){var needsIgnoring;var sibling;var parent,previousSibling,nextSibling;var isText=false;if(anchor.nodeType===TEXT_NODE){isText=true;parent=anchor.parentNode;needsIgnoring=anchor.parentNode.classList.contains(ignoreClass);}else{isText=false;needsIgnoring=anchor.classList.contains(ignoreClass);}if(needsIgnoring&&isText){previousSibling=parent.previousSibling;nextSibling=parent.nextSibling;if(previousSibling&&previousSibling.nodeType===TEXT_NODE){sibling=previousSibling;}else if(nextSibling&&nextSibling.nodeType===TEXT_NODE){sibling=nextSibling;}if(sibling){return sibling;}else{return anchor;}}else if(needsIgnoring&&!isText){return false;}else{return anchor;}}},{key:"patchOffset",value:function patchOffset(anchor,offset,ignoreClass){if(anchor.nodeType!=TEXT_NODE){throw new Error("Anchor must be a text node");}var curr=anchor;var totalOffset=offset;if(anchor.parentNode.classList.contains(ignoreClass)){curr=anchor.parentNode;}while(curr.previousSibling){if(curr.previousSibling.nodeType===ELEMENT_NODE){if(curr.previousSibling.classList.contains(ignoreClass)){totalOffset+=curr.previousSibling.textContent.length;}else{break;}}else{totalOffset+=curr.previousSibling.textContent.length;}curr=curr.previousSibling;}return totalOffset;}},{key:"normalizedMap",value:function normalizedMap(children,nodeType,ignoreClass){var output={};var prevIndex=-1;var i,len=children.length;var currNodeType;var prevNodeType;for(i=0;i<len;i++){currNodeType=children[i].nodeType;if(currNodeType===ELEMENT_NODE&&children[i].classList.contains(ignoreClass)){currNodeType=TEXT_NODE;}if(i>0&&currNodeType===TEXT_NODE&&prevNodeType===TEXT_NODE){output[i]=prevIndex;}else if(nodeType===currNodeType){prevIndex=prevIndex+1;output[i]=prevIndex;}prevNodeType=currNodeType;}return output;}},{key:"position",value:function position(anchor){var children,index;if(anchor.nodeType===ELEMENT_NODE){children=anchor.parentNode.children;if(!children){children=(0,_core.findChildren)(anchor.parentNode);}index=Array.prototype.indexOf.call(children,anchor);}else{children=this.textNodes(anchor.parentNode);index=children.indexOf(anchor);}return index;}},{key:"filteredPosition",value:function filteredPosition(anchor,ignoreClass){var children,index,map;if(anchor.nodeType===ELEMENT_NODE){children=anchor.parentNode.children;map=this.normalizedMap(children,ELEMENT_NODE,ignoreClass);}else{children=anchor.parentNode.childNodes;if(anchor.parentNode.classList.contains(ignoreClass)){anchor=anchor.parentNode;children=anchor.parentNode.childNodes;}map=this.normalizedMap(children,TEXT_NODE,ignoreClass);}index=Array.prototype.indexOf.call(children,anchor);return map[index];}},{key:"stepsToXpath",value:function stepsToXpath(steps){var xpath=[".","*"];steps.forEach(function(step){var position=step.index+1;if(step.id){xpath.push("*[position()="+position+" and @id=\'"+step.id+"\']");}else if(step.type==="text"){xpath.push("text()["+position+"]");}else{xpath.push("*["+position+"]");}});return xpath.join("/");}},{key:"stepsToQuerySelector",value:function stepsToQuerySelector(steps){var query=["html"];steps.forEach(function(step){var position=step.index+1;if(step.id){query.push("#"+step.id);}else if(step.type==="text"){}else{query.push("*:nth-child("+position+")");}});return query.join(">");}},{key:"textNodes",value:function textNodes(container,ignoreClass){return Array.prototype.slice.call(container.childNodes).filter(function(node){if(node.nodeType===TEXT_NODE){return true;}else if(ignoreClass&&node.classList.contains(ignoreClass)){return true;}return false;});}},{key:"walkToNode",value:function walkToNode(steps,_doc,ignoreClass){var doc=_doc||document;var container=doc.documentElement;var children;var step;var len=steps.length;var i;for(i=0;i<len;i++){step=steps[i];if(step.type==="element"){if(step.id){container=doc.getElementById(step.id);}else{children=container.children||(0,_core.findChildren)(container);container=children[step.index];}}else if(step.type==="text"){container=this.textNodes(container,ignoreClass)[step.index];}if(!container){break;}}return container;}},{key:"findNode",value:function findNode(steps,_doc,ignoreClass){var doc=_doc||document;var container;var xpath;if(!ignoreClass&&typeof doc.evaluate!="undefined"){xpath=this.stepsToXpath(steps);container=doc.evaluate(xpath,doc,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;}else if(ignoreClass){container=this.walkToNode(steps,doc,ignoreClass);}else{container=this.walkToNode(steps,doc);}return container;}},{key:"fixMiss",value:function fixMiss(steps,offset,_doc,ignoreClass){var container=this.findNode(steps.slice(0,-1),_doc,ignoreClass);var children=container.childNodes;var map=this.normalizedMap(children,TEXT_NODE,ignoreClass);var child;var len;var lastStepIndex=steps[steps.length-1].index;for(var childIndex in map){if(!map.hasOwnProperty(childIndex))return;if(map[childIndex]===lastStepIndex){child=children[childIndex];len=child.textContent.length;if(offset>len){offset=offset-len;}else{if(child.nodeType===ELEMENT_NODE){container=child.childNodes[0];}else{container=child;}break;}}}return{container:container,offset:offset};}},{key:"toRange",value:function toRange(_doc,ignoreClass){var doc=_doc||document;var range;var start,end,startContainer,endContainer;var cfi=this;var startSteps,endSteps;var needsIgnoring=ignoreClass?doc.querySelector("."+ignoreClass)!=null:false;var missed;if(typeof doc.createRange!=="undefined"){range=doc.createRange();}else{range=new _core.RangeObject();}if(cfi.range){start=cfi.start;startSteps=cfi.path.steps.concat(start.steps);startContainer=this.findNode(startSteps,doc,needsIgnoring?ignoreClass:null);end=cfi.end;endSteps=cfi.path.steps.concat(end.steps);endContainer=this.findNode(endSteps,doc,needsIgnoring?ignoreClass:null);}else{start=cfi.path;startSteps=cfi.path.steps;startContainer=this.findNode(cfi.path.steps,doc,needsIgnoring?ignoreClass:null);}if(startContainer){try{if(start.terminal.offset!=null){range.setStart(startContainer,start.terminal.offset);}else{range.setStart(startContainer,0);}}catch(e){missed=this.fixMiss(startSteps,start.terminal.offset,doc,needsIgnoring?ignoreClass:null);range.setStart(missed.container,missed.offset);}}else{console.log("No startContainer found for",this.toString());return null;}if(endContainer){try{if(end.terminal.offset!=null){range.setEnd(endContainer,end.terminal.offset);}else{range.setEnd(endContainer,0);}}catch(e){missed=this.fixMiss(endSteps,cfi.end.terminal.offset,doc,needsIgnoring?ignoreClass:null);range.setEnd(missed.container,missed.offset);}}return range;}},{key:"isCfiString",value:function isCfiString(str){if(typeof str==="string"&&str.indexOf("epubcfi(")===0&&str[str.length-1]===")"){return true;}return false;}},{key:"generateChapterComponent",value:function generateChapterComponent(_spineNodeIndex,_pos,id){var pos=parseInt(_pos),spineNodeIndex=(_spineNodeIndex+1)*2,cfi="/"+spineNodeIndex+"/";cfi+=(pos+1)*2;if(id){cfi+="["+id+"]";}return cfi;}},{key:"collapse",value:function collapse(toStart){if(!this.range){return;}this.range=false;if(toStart){this.path.steps=this.path.steps.concat(this.start.steps);this.path.terminal=this.start.terminal;}else{this.path.steps=this.path.steps.concat(this.end.steps);this.path.terminal=this.end.terminal;}}}]);return EpubCFI;}();exports.default=EpubCFI;module.exports=exports["default"];\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/epubjs/lib/epubcfi.js?')},"./node_modules/epubjs/lib/mapping.js":function(e,t,r){'use strict';eval('Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _epubcfi=__webpack_require__(/*! ./epubcfi */ "./node_modules/epubjs/lib/epubcfi.js");var _epubcfi2=_interopRequireDefault(_epubcfi);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var Mapping=function(){function Mapping(layout,direction,axis,dev){_classCallCheck(this,Mapping);this.layout=layout;this.horizontal=axis==="horizontal"?true:false;this.direction=direction||"ltr";this._dev=dev;}_createClass(Mapping,[{key:"section",value:function section(view){var ranges=this.findRanges(view);var map=this.rangeListToCfiList(view.section.cfiBase,ranges);return map;}},{key:"page",value:function page(contents,cfiBase,start,end){var root=contents&&contents.document?contents.document.body:false;var result;if(!root){return;}result=this.rangePairToCfiPair(cfiBase,{start:this.findStart(root,start,end),end:this.findEnd(root,start,end)});if(this._dev===true){var doc=contents.document;var startRange=new _epubcfi2.default(result.start).toRange(doc);var endRange=new _epubcfi2.default(result.end).toRange(doc);var selection=doc.defaultView.getSelection();var r=doc.createRange();selection.removeAllRanges();r.setStart(startRange.startContainer,startRange.startOffset);r.setEnd(endRange.endContainer,endRange.endOffset);selection.addRange(r);}return result;}},{key:"walk",value:function walk(root,func){if(root&&root.nodeType===Node.TEXT_NODE){return;}var filter={acceptNode:function acceptNode(node){if(node.data.trim().length>0){return NodeFilter.FILTER_ACCEPT;}else{return NodeFilter.FILTER_REJECT;}}};var safeFilter=filter.acceptNode;safeFilter.acceptNode=filter.acceptNode;var treeWalker=document.createTreeWalker(root,NodeFilter.SHOW_TEXT,safeFilter,false);var node;var result;while(node=treeWalker.nextNode()){result=func(node);if(result)break;}return result;}},{key:"findRanges",value:function findRanges(view){var columns=[];var scrollWidth=view.contents.scrollWidth();var spreads=Math.ceil(scrollWidth/this.layout.spreadWidth);var count=spreads*this.layout.divisor;var columnWidth=this.layout.columnWidth;var gap=this.layout.gap;var start,end;for(var i=0;i<count.pages;i++){start=(columnWidth+gap)*i;end=columnWidth*(i+1)+gap*i;columns.push({start:this.findStart(view.document.body,start,end),end:this.findEnd(view.document.body,start,end)});}return columns;}},{key:"findStart",value:function findStart(root,start,end){var _this=this;var stack=[root];var $el;var found;var $prev=root;while(stack.length){$el=stack.shift();found=this.walk($el,function(node){var left,right,top,bottom;var elPos;var elRange;elPos=_this.getBounds(node);if(_this.horizontal&&_this.direction==="ltr"){left=_this.horizontal?elPos.left:elPos.top;right=_this.horizontal?elPos.right:elPos.bottom;if(left>=start&&left<=end){return node;}else if(right>start){return node;}else{$prev=node;stack.push(node);}}else if(_this.horizontal&&_this.direction==="rtl"){left=elPos.left;right=elPos.right;if(right<=end&&right>=start){return node;}else if(left<end){return node;}else{$prev=node;stack.push(node);}}else{top=elPos.top;bottom=elPos.bottom;if(top>=start&&top<=end){return node;}else if(bottom>start){return node;}else{$prev=node;stack.push(node);}}});if(found){return this.findTextStartRange(found,start,end);}}return this.findTextStartRange($prev,start,end);}},{key:"findEnd",value:function findEnd(root,start,end){var _this2=this;var stack=[root];var $el;var $prev=root;var found;while(stack.length){$el=stack.shift();found=this.walk($el,function(node){var left,right,top,bottom;var elPos;var elRange;elPos=_this2.getBounds(node);if(_this2.horizontal&&_this2.direction==="ltr"){left=Math.round(elPos.left);right=Math.round(elPos.right);if(left>end&&$prev){return $prev;}else if(right>end){return node;}else{$prev=node;stack.push(node);}}else if(_this2.horizontal&&_this2.direction==="rtl"){left=Math.round(_this2.horizontal?elPos.left:elPos.top);right=Math.round(_this2.horizontal?elPos.right:elPos.bottom);if(right<start&&$prev){return $prev;}else if(left<start){return node;}else{$prev=node;stack.push(node);}}else{top=Math.round(elPos.top);bottom=Math.round(elPos.bottom);if(top>end&&$prev){return $prev;}else if(bottom>end){return node;}else{$prev=node;stack.push(node);}}});if(found){return this.findTextEndRange(found,start,end);}}return this.findTextEndRange($prev,start,end);}},{key:"findTextStartRange",value:function findTextStartRange(node,start,end){var ranges=this.splitTextNodeIntoRanges(node);var range;var pos;var left,top,right;for(var i=0;i<ranges.length;i++){range=ranges[i];pos=range.getBoundingClientRect();if(this.horizontal&&this.direction==="ltr"){left=pos.left;if(left>=start){return range;}}else if(this.horizontal&&this.direction==="rtl"){right=pos.right;if(right<=end){return range;}}else{top=pos.top;if(top>=start){return range;}}}return ranges[0];}},{key:"findTextEndRange",value:function findTextEndRange(node,start,end){var ranges=this.splitTextNodeIntoRanges(node);var prev;var range;var pos;var left,right,top,bottom;for(var i=0;i<ranges.length;i++){range=ranges[i];pos=range.getBoundingClientRect();if(this.horizontal&&this.direction==="ltr"){left=pos.left;right=pos.right;if(left>end&&prev){return prev;}else if(right>end){return range;}}else if(this.horizontal&&this.direction==="rtl"){left=pos.left;right=pos.right;if(right<start&&prev){return prev;}else if(left<start){return range;}}else{top=pos.top;bottom=pos.bottom;if(top>end&&prev){return prev;}else if(bottom>end){return range;}}prev=range;}return ranges[ranges.length-1];}},{key:"splitTextNodeIntoRanges",value:function splitTextNodeIntoRanges(node,_splitter){var ranges=[];var textContent=node.textContent||"";var text=textContent.trim();var range;var doc=node.ownerDocument;var splitter=_splitter||" ";var pos=text.indexOf(splitter);if(pos===-1||node.nodeType!=Node.TEXT_NODE){range=doc.createRange();range.selectNodeContents(node);return[range];}range=doc.createRange();range.setStart(node,0);range.setEnd(node,pos);ranges.push(range);range=false;while(pos!=-1){pos=text.indexOf(splitter,pos+1);if(pos>0){if(range){range.setEnd(node,pos);ranges.push(range);}range=doc.createRange();range.setStart(node,pos+1);}}if(range){range.setEnd(node,text.length);ranges.push(range);}return ranges;}},{key:"rangePairToCfiPair",value:function rangePairToCfiPair(cfiBase,rangePair){var startRange=rangePair.start;var endRange=rangePair.end;startRange.collapse(true);endRange.collapse(false);var startCfi=new _epubcfi2.default(startRange,cfiBase).toString();var endCfi=new _epubcfi2.default(endRange,cfiBase).toString();return{start:startCfi,end:endCfi};}},{key:"rangeListToCfiList",value:function rangeListToCfiList(cfiBase,columns){var map=[];var cifPair;for(var i=0;i<columns.length;i++){cifPair=this.rangePairToCfiPair(cfiBase,columns[i]);map.push(cifPair);}return map;}},{key:"getBounds",value:function getBounds(node){var elPos=void 0;if(node.nodeType==Node.TEXT_NODE){var elRange=document.createRange();elRange.selectNodeContents(node);elPos=elRange.getBoundingClientRect();}else{elPos=node.getBoundingClientRect();}return elPos;}},{key:"axis",value:function axis(_axis){if(_axis){this.horizontal=_axis==="horizontal"?true:false;}return this.horizontal;}}]);return Mapping;}();exports.default=Mapping;module.exports=exports["default"];\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/epubjs/lib/mapping.js?')},"./node_modules/epubjs/lib/utils/constants.js":function(e,t,r){'use strict';eval('Object.defineProperty(exports,"__esModule",{value:true});var DOM_EVENTS=exports.DOM_EVENTS=["keydown","keyup","keypressed","mouseup","mousedown","click","touchend","touchstart"];var EVENTS=exports.EVENTS={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled"},VIEWS:{AXIS:"axis",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"}};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/epubjs/lib/utils/constants.js?')},"./node_modules/epubjs/lib/utils/core.js":function(e,t,r){'use strict';eval('Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();exports.uuid=uuid;exports.documentHeight=documentHeight;exports.isElement=isElement;exports.isNumber=isNumber;exports.isFloat=isFloat;exports.prefixed=prefixed;exports.defaults=defaults;exports.extend=extend;exports.insert=insert;exports.locationOf=locationOf;exports.indexOfSorted=indexOfSorted;exports.bounds=bounds;exports.borders=borders;exports.windowBounds=windowBounds;exports.indexOfNode=indexOfNode;exports.indexOfTextNode=indexOfTextNode;exports.indexOfElementNode=indexOfElementNode;exports.isXml=isXml;exports.createBlob=createBlob;exports.createBlobUrl=createBlobUrl;exports.revokeBlobUrl=revokeBlobUrl;exports.createBase64Url=createBase64Url;exports.type=type;exports.parse=parse;exports.qs=qs;exports.qsa=qsa;exports.qsp=qsp;exports.sprint=sprint;exports.treeWalker=treeWalker;exports.walk=walk;exports.blob2base64=blob2base64;exports.defer=defer;exports.querySelectorByType=querySelectorByType;exports.findChildren=findChildren;exports.parents=parents;exports.filterChildren=filterChildren;exports.getParentByTagName=getParentByTagName;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var requestAnimationFrame=exports.requestAnimationFrame=typeof window!="undefined"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:false;var ELEMENT_NODE=1;var TEXT_NODE=3;var COMMENT_NODE=8;var DOCUMENT_NODE=9;var _URL=typeof URL!="undefined"?URL:typeof window!="undefined"?window.URL||window.webkitURL||window.mozURL:undefined;function uuid(){var d=new Date().getTime();var uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+Math.random()*16)%16|0;d=Math.floor(d/16);return(c=="x"?r:r&0x7|0x8).toString(16);});return uuid;}function documentHeight(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight);}function isElement(obj){return!!(obj&&obj.nodeType==1);}function isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n);}function isFloat(n){var f=parseFloat(n);if(isNumber(n)===false){return false;}if(typeof n==="string"&&n.indexOf(".")>-1){return true;}return Math.floor(f)!==f;}function prefixed(unprefixed){var vendors=["Webkit","webkit","Moz","O","ms"];var prefixes=["-webkit-","-webkit-","-moz-","-o-","-ms-"];var upper=unprefixed[0].toUpperCase()+unprefixed.slice(1);var length=vendors.length;if(typeof document==="undefined"||typeof document.body.style[unprefixed]!="undefined"){return unprefixed;}for(var i=0;i<length;i++){if(typeof document.body.style[vendors[i]+upper]!="undefined"){return prefixes[i]+unprefixed;}}return unprefixed;}function defaults(obj){for(var i=1,length=arguments.length;i<length;i++){var source=arguments[i];for(var prop in source){if(obj[prop]===void 0)obj[prop]=source[prop];}}return obj;}function extend(target){var sources=[].slice.call(arguments,1);sources.forEach(function(source){if(!source)return;Object.getOwnPropertyNames(source).forEach(function(propName){Object.defineProperty(target,propName,Object.getOwnPropertyDescriptor(source,propName));});});return target;}function insert(item,array,compareFunction){var location=locationOf(item,array,compareFunction);array.splice(location,0,item);return location;}function locationOf(item,array,compareFunction,_start,_end){var start=_start||0;var end=_end||array.length;var pivot=parseInt(start+(end-start)/2);var compared;if(!compareFunction){compareFunction=function compareFunction(a,b){if(a>b)return 1;if(a<b)return-1;if(a==b)return 0;};}if(end-start<=0){return pivot;}compared=compareFunction(array[pivot],item);if(end-start===1){return compared>=0?pivot:pivot+1;}if(compared===0){return pivot;}if(compared===-1){return locationOf(item,array,compareFunction,pivot,end);}else{return locationOf(item,array,compareFunction,start,pivot);}}function indexOfSorted(item,array,compareFunction,_start,_end){var start=_start||0;var end=_end||array.length;var pivot=parseInt(start+(end-start)/2);var compared;if(!compareFunction){compareFunction=function compareFunction(a,b){if(a>b)return 1;if(a<b)return-1;if(a==b)return 0;};}if(end-start<=0){return-1;}compared=compareFunction(array[pivot],item);if(end-start===1){return compared===0?pivot:-1;}if(compared===0){return pivot;}if(compared===-1){return indexOfSorted(item,array,compareFunction,pivot,end);}else{return indexOfSorted(item,array,compareFunction,start,pivot);}}function bounds(el){var style=window.getComputedStyle(el);var widthProps=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"];var heightProps=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"];var width=0;var height=0;widthProps.forEach(function(prop){width+=parseFloat(style[prop])||0;});heightProps.forEach(function(prop){height+=parseFloat(style[prop])||0;});return{height:height,width:width};}function borders(el){var style=window.getComputedStyle(el);var widthProps=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"];var heightProps=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"];var width=0;var height=0;widthProps.forEach(function(prop){width+=parseFloat(style[prop])||0;});heightProps.forEach(function(prop){height+=parseFloat(style[prop])||0;});return{height:height,width:width};}function windowBounds(){var width=window.innerWidth;var height=window.innerHeight;return{top:0,left:0,right:width,bottom:height,width:width,height:height};}function indexOfNode(node,typeId){var parent=node.parentNode;var children=parent.childNodes;var sib;var index=-1;for(var i=0;i<children.length;i++){sib=children[i];if(sib.nodeType===typeId){index++;}if(sib==node)break;}return index;}function indexOfTextNode(textNode){return indexOfNode(textNode,TEXT_NODE);}function indexOfElementNode(elementNode){return indexOfNode(elementNode,ELEMENT_NODE);}function isXml(ext){return["xml","opf","ncx"].indexOf(ext)>-1;}function createBlob(content,mime){return new Blob([content],{type:mime});}function createBlobUrl(content,mime){var tempUrl;var blob=createBlob(content,mime);tempUrl=_URL.createObjectURL(blob);return tempUrl;}function revokeBlobUrl(url){return _URL.revokeObjectURL(url);}function createBase64Url(content,mime){var data;var datauri;if(typeof content!=="string"){return;}data=btoa(encodeURIComponent(content));datauri="data:"+mime+";base64,"+data;return datauri;}function type(obj){return Object.prototype.toString.call(obj).slice(8,-1);}function parse(markup,mime,forceXMLDom){var doc;var Parser;if(typeof DOMParser==="undefined"||forceXMLDom){Parser=__webpack_require__(/*! xmldom */ "xmldom").DOMParser;}else{Parser=DOMParser;}if(markup.charCodeAt(0)===0xFEFF){markup=markup.slice(1);}doc=new Parser().parseFromString(markup,mime);return doc;}function qs(el,sel){var elements;if(!el){throw new Error("No Element Provided");}if(typeof el.querySelector!="undefined"){return el.querySelector(sel);}else{elements=el.getElementsByTagName(sel);if(elements.length){return elements[0];}}}function qsa(el,sel){if(typeof el.querySelector!="undefined"){return el.querySelectorAll(sel);}else{return el.getElementsByTagName(sel);}}function qsp(el,sel,props){var q,filtered;if(typeof el.querySelector!="undefined"){sel+="[";for(var prop in props){sel+=prop+"~=\'"+props[prop]+"\'";}sel+="]";return el.querySelector(sel);}else{q=el.getElementsByTagName(sel);filtered=Array.prototype.slice.call(q,0).filter(function(el){for(var prop in props){if(el.getAttribute(prop)===props[prop]){return true;}}return false;});if(filtered){return filtered[0];}}}function sprint(root,func){var doc=root.ownerDocument||root;if(typeof doc.createTreeWalker!=="undefined"){treeWalker(root,func,NodeFilter.SHOW_TEXT);}else{walk(root,function(node){if(node&&node.nodeType===3){func(node);}},true);}}function treeWalker(root,func,filter){var treeWalker=document.createTreeWalker(root,filter,null,false);var node=void 0;while(node=treeWalker.nextNode()){func(node);}}function walk(node,callback){if(callback(node)){return true;}node=node.firstChild;if(node){do{var walked=walk(node,callback);if(walked){return true;}node=node.nextSibling;}while(node);}}function blob2base64(blob){return new Promise(function(resolve,reject){var reader=new FileReader();reader.readAsDataURL(blob);reader.onloadend=function(){resolve(reader.result);};});}function defer(){var _this=this;this.resolve=null;this.reject=null;this.id=uuid();this.promise=new Promise(function(resolve,reject){_this.resolve=resolve;_this.reject=reject;});Object.freeze(this);}function querySelectorByType(html,element,type){var query;if(typeof html.querySelector!="undefined"){query=html.querySelector(element+"[*|type=\\""+type+"\\"]");}if(!query||query.length===0){query=qsa(html,element);for(var i=0;i<query.length;i++){if(query[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===type||query[i].getAttribute("epub:type")===type){return query[i];}}}else{return query;}}function findChildren(el){var result=[];var childNodes=el.childNodes;for(var i=0;i<childNodes.length;i++){var node=childNodes[i];if(node.nodeType===1){result.push(node);}}return result;}function parents(node){var nodes=[node];for(;node;node=node.parentNode){nodes.unshift(node);}return nodes;}function filterChildren(el,nodeName,single){var result=[];var childNodes=el.childNodes;for(var i=0;i<childNodes.length;i++){var node=childNodes[i];if(node.nodeType===1&&node.nodeName.toLowerCase()===nodeName){if(single){return node;}else{result.push(node);}}}if(!single){return result;}}function getParentByTagName(node,tagname){var parent=void 0;if(node===null||tagname===\'\')return;parent=node.parentNode;while(parent.nodeType===1){if(parent.tagName.toLowerCase()===tagname){return parent;}parent=parent.parentNode;}}var RangeObject=exports.RangeObject=function(){function RangeObject(){_classCallCheck(this,RangeObject);this.collapsed=false;this.commonAncestorContainer=undefined;this.endContainer=undefined;this.endOffset=undefined;this.startContainer=undefined;this.startOffset=undefined;}_createClass(RangeObject,[{key:"setStart",value:function setStart(startNode,startOffset){this.startContainer=startNode;this.startOffset=startOffset;if(!this.endContainer){this.collapse(true);}else{this.commonAncestorContainer=this._commonAncestorContainer();}this._checkCollapsed();}},{key:"setEnd",value:function setEnd(endNode,endOffset){this.endContainer=endNode;this.endOffset=endOffset;if(!this.startContainer){this.collapse(false);}else{this.collapsed=false;this.commonAncestorContainer=this._commonAncestorContainer();}this._checkCollapsed();}},{key:"collapse",value:function collapse(toStart){this.collapsed=true;if(toStart){this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.commonAncestorContainer=this.startContainer.parentNode;}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset;this.commonAncestorContainer=this.endOffset.parentNode;}}},{key:"selectNode",value:function selectNode(referenceNode){var parent=referenceNode.parentNode;var index=Array.prototype.indexOf.call(parent.childNodes,referenceNode);this.setStart(parent,index);this.setEnd(parent,index+1);}},{key:"selectNodeContents",value:function selectNodeContents(referenceNode){var end=referenceNode.childNodes[referenceNode.childNodes-1];var endIndex=referenceNode.nodeType===3?referenceNode.textContent.length:parent.childNodes.length;this.setStart(referenceNode,0);this.setEnd(referenceNode,endIndex);}},{key:"_commonAncestorContainer",value:function _commonAncestorContainer(startContainer,endContainer){var startParents=parents(startContainer||this.startContainer);var endParents=parents(endContainer||this.endContainer);if(startParents[0]!=endParents[0])return undefined;for(var i=0;i<startParents.length;i++){if(startParents[i]!=endParents[i]){return startParents[i-1];}}}},{key:"_checkCollapsed",value:function _checkCollapsed(){if(this.startContainer===this.endContainer&&this.startOffset===this.endOffset){this.collapsed=true;}else{this.collapsed=false;}}},{key:"toString",value:function toString(){}}]);return RangeObject;}();\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/epubjs/lib/utils/core.js?')},"./node_modules/epubjs/lib/utils/path.js":function(e,t,r){'use strict';eval('Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _pathWebpack=__webpack_require__(/*! path-webpack */ "./node_modules/path-webpack/path.js");var _pathWebpack2=_interopRequireDefault(_pathWebpack);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var Path=function(){function Path(pathString){_classCallCheck(this,Path);var protocol;var parsed;protocol=pathString.indexOf("://");if(protocol>-1){pathString=new URL(pathString).pathname;}parsed=this.parse(pathString);this.path=pathString;if(this.isDirectory(pathString)){this.directory=pathString;}else{this.directory=parsed.dir+"/";}this.filename=parsed.base;this.extension=parsed.ext.slice(1);}_createClass(Path,[{key:"parse",value:function parse(what){return _pathWebpack2.default.parse(what);}},{key:"isAbsolute",value:function isAbsolute(what){return _pathWebpack2.default.isAbsolute(what||this.path);}},{key:"isDirectory",value:function isDirectory(what){return what.charAt(what.length-1)==="/";}},{key:"resolve",value:function resolve(what){return _pathWebpack2.default.resolve(this.directory,what);}},{key:"relative",value:function relative(what){return _pathWebpack2.default.relative(this.directory,what);}},{key:"splitPath",value:function splitPath(filename){return this.splitPathRe.exec(filename).slice(1);}},{key:"toString",value:function toString(){return this.path;}}]);return Path;}();exports.default=Path;module.exports=exports["default"];\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/epubjs/lib/utils/path.js?')},"./node_modules/epubjs/lib/utils/replacements.js":function(e,t,r){'use strict';eval('Object.defineProperty(exports,"__esModule",{value:true});exports.replaceBase=replaceBase;exports.replaceCanonical=replaceCanonical;exports.replaceMeta=replaceMeta;exports.replaceLinks=replaceLinks;exports.substitute=substitute;var _core=__webpack_require__(/*! ./core */ "./node_modules/epubjs/lib/utils/core.js");var _url=__webpack_require__(/*! ./url */ "./node_modules/epubjs/lib/utils/url.js");var _url2=_interopRequireDefault(_url);var _path=__webpack_require__(/*! ./path */ "./node_modules/epubjs/lib/utils/path.js");var _path2=_interopRequireDefault(_path);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function replaceBase(doc,section){var base;var head;var url=section.url;var absolute=url.indexOf("://")>-1;if(!doc){return;}head=(0,_core.qs)(doc,"head");base=(0,_core.qs)(head,"base");if(!base){base=doc.createElement("base");head.insertBefore(base,head.firstChild);}if(!absolute&&window&&window.location){url=window.location.origin+url;}base.setAttribute("href",url);}function replaceCanonical(doc,section){var head;var link;var url=section.canonical;if(!doc){return;}head=(0,_core.qs)(doc,"head");link=(0,_core.qs)(head,"link[rel=\'canonical\']");if(link){link.setAttribute("href",url);}else{link=doc.createElement("link");link.setAttribute("rel","canonical");link.setAttribute("href",url);head.appendChild(link);}}function replaceMeta(doc,section){var head;var meta;var id=section.idref;if(!doc){return;}head=(0,_core.qs)(doc,"head");meta=(0,_core.qs)(head,"link[property=\'dc.identifier\']");if(meta){meta.setAttribute("content",id);}else{meta=doc.createElement("meta");meta.setAttribute("name","dc.identifier");meta.setAttribute("content",id);head.appendChild(meta);}}function replaceLinks(contents,fn){var links=contents.querySelectorAll("a[href]");if(!links.length){return;}var base=(0,_core.qs)(contents.ownerDocument,"base");var location=base?base.getAttribute("href"):undefined;var replaceLink=function(link){var href=link.getAttribute("href");if(href.indexOf("mailto:")===0){return;}var absolute=href.indexOf("://")>-1;var linkUrl=new _url2.default(href,location);if(absolute){link.setAttribute("target","_blank");}else{link.onclick=function(){if(linkUrl&&linkUrl.hash){fn(linkUrl.Path.path+linkUrl.hash);}else if(linkUrl){fn(linkUrl.Path.path);}else{fn(href);}return false;};}}.bind(this);for(var i=0;i<links.length;i++){replaceLink(links[i]);}}function substitute(content,urls,replacements){urls.forEach(function(url,i){if(url&&replacements[i]){content=content.replace(new RegExp(url,"g"),replacements[i]);}});return content;}\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/epubjs/lib/utils/replacements.js?')},"./node_modules/epubjs/lib/utils/url.js":function(e,t,r){'use strict';eval('Object.defineProperty(exports,"__esModule",{value:true});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _path=__webpack_require__(/*! ./path */ "./node_modules/epubjs/lib/utils/path.js");var _path2=_interopRequireDefault(_path);var _pathWebpack=__webpack_require__(/*! path-webpack */ "./node_modules/path-webpack/path.js");var _pathWebpack2=_interopRequireDefault(_pathWebpack);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var Url=function(){function Url(urlString,baseString){_classCallCheck(this,Url);var absolute=urlString.indexOf("://")>-1;var pathname=urlString;var basePath;this.Url=undefined;this.href=urlString;this.protocol="";this.origin="";this.hash="";this.hash="";this.search="";this.base=baseString;if(!absolute&&baseString!==false&&typeof baseString!=="string"&&window&&window.location){this.base=window.location.href;}if(absolute||this.base){try{if(this.base){this.Url=new URL(urlString,this.base);}else{this.Url=new URL(urlString);}this.href=this.Url.href;this.protocol=this.Url.protocol;this.origin=this.Url.origin;this.hash=this.Url.hash;this.search=this.Url.search;pathname=this.Url.pathname;}catch(e){this.Url=undefined;if(this.base){basePath=new _path2.default(this.base);pathname=basePath.resolve(pathname);}}}this.Path=new _path2.default(pathname);this.directory=this.Path.directory;this.filename=this.Path.filename;this.extension=this.Path.extension;}_createClass(Url,[{key:"path",value:function path(){return this.Path;}},{key:"resolve",value:function resolve(what){var isAbsolute=what.indexOf("://")>-1;var fullpath;if(isAbsolute){return what;}fullpath=_pathWebpack2.default.resolve(this.directory,what);return this.origin+fullpath;}},{key:"relative",value:function relative(what){return _pathWebpack2.default.relative(what,this.directory);}},{key:"toString",value:function toString(){return this.href;}}]);return Url;}();exports.default=Url;module.exports=exports["default"];\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/epubjs/lib/utils/url.js?')},"./node_modules/es5-ext/function/noop.js":function(e,t,r){'use strict';eval('module.exports=function(){};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/function/noop.js?')},"./node_modules/es5-ext/object/assign/index.js":function(e,t,r){'use strict';eval('module.exports=__webpack_require__(/*! ./is-implemented */ "./node_modules/es5-ext/object/assign/is-implemented.js")()?Object.assign:__webpack_require__(/*! ./shim */ "./node_modules/es5-ext/object/assign/shim.js");\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/assign/index.js?')},"./node_modules/es5-ext/object/assign/is-implemented.js":function(e,t,r){'use strict';eval('module.exports=function(){var assign=Object.assign,obj;if(typeof assign!=="function")return false;obj={foo:"raz"};assign(obj,{bar:"dwa"},{trzy:"trzy"});return obj.foo+obj.bar+obj.trzy==="razdwatrzy";};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/assign/is-implemented.js?')},"./node_modules/es5-ext/object/assign/shim.js":function(e,t,r){'use strict';eval('var keys=__webpack_require__(/*! ../keys */ "./node_modules/es5-ext/object/keys/index.js"),value=__webpack_require__(/*! ../valid-value */ "./node_modules/es5-ext/object/valid-value.js"),max=Math.max;module.exports=function(dest,src){var error,i,length=max(arguments.length,2),assign;dest=Object(value(dest));assign=function assign(key){try{dest[key]=src[key];}catch(e){if(!error)error=e;}};for(i=1;i<length;++i){src=arguments[i];keys(src).forEach(assign);}if(error!==undefined)throw error;return dest;};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/assign/shim.js?')},"./node_modules/es5-ext/object/is-callable.js":function(e,t,r){'use strict';eval('module.exports=function(obj){return typeof obj==="function";};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/is-callable.js?')},"./node_modules/es5-ext/object/is-value.js":function(e,t,r){'use strict';eval('var _undefined=__webpack_require__(/*! ../function/noop */ "./node_modules/es5-ext/function/noop.js")();module.exports=function(val){return val!==_undefined&&val!==null;};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/is-value.js?')},"./node_modules/es5-ext/object/keys/index.js":function(e,t,r){'use strict';eval('module.exports=__webpack_require__(/*! ./is-implemented */ "./node_modules/es5-ext/object/keys/is-implemented.js")()?Object.keys:__webpack_require__(/*! ./shim */ "./node_modules/es5-ext/object/keys/shim.js");\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/keys/index.js?')},"./node_modules/es5-ext/object/keys/is-implemented.js":function(e,t,r){'use strict';eval('module.exports=function(){try{Object.keys("primitive");return true;}catch(e){return false;}};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/keys/is-implemented.js?')},"./node_modules/es5-ext/object/keys/shim.js":function(e,t,r){'use strict';eval('var isValue=__webpack_require__(/*! ../is-value */ "./node_modules/es5-ext/object/is-value.js");var keys=Object.keys;module.exports=function(object){return keys(isValue(object)?Object(object):object);};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/keys/shim.js?')},"./node_modules/es5-ext/object/normalize-options.js":function(e,t,r){'use strict';eval('var isValue=__webpack_require__(/*! ./is-value */ "./node_modules/es5-ext/object/is-value.js");var forEach=Array.prototype.forEach,create=Object.create;var process=function process(src,obj){var key;for(key in src){obj[key]=src[key];}};module.exports=function(opts1){var result=create(null);forEach.call(arguments,function(options){if(!isValue(options))return;process(Object(options),result);});return result;};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/normalize-options.js?')},"./node_modules/es5-ext/object/valid-callable.js":function(e,t,r){'use strict';eval('module.exports=function(fn){if(typeof fn!=="function")throw new TypeError(fn+" is not a function");return fn;};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/valid-callable.js?')},"./node_modules/es5-ext/object/valid-value.js":function(e,t,r){'use strict';eval('var isValue=__webpack_require__(/*! ./is-value */ "./node_modules/es5-ext/object/is-value.js");module.exports=function(value){if(!isValue(value))throw new TypeError("Cannot use null or undefined");return value;};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/object/valid-value.js?')},"./node_modules/es5-ext/string/#/contains/index.js":function(e,t,r){'use strict';eval('module.exports=__webpack_require__(/*! ./is-implemented */ "./node_modules/es5-ext/string/#/contains/is-implemented.js")()?String.prototype.contains:__webpack_require__(/*! ./shim */ "./node_modules/es5-ext/string/#/contains/shim.js");\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/string/#/contains/index.js?')},"./node_modules/es5-ext/string/#/contains/is-implemented.js":function(e,t,r){'use strict';eval('var str="razdwatrzy";module.exports=function(){if(typeof str.contains!=="function")return false;return str.contains("dwa")===true&&str.contains("foo")===false;};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/string/#/contains/is-implemented.js?')},"./node_modules/es5-ext/string/#/contains/shim.js":function(e,t,r){'use strict';eval('var indexOf=String.prototype.indexOf;module.exports=function(searchString){return indexOf.call(this,searchString,arguments[1])>-1;};\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/es5-ext/string/#/contains/shim.js?')},"./node_modules/event-emitter/index.js":function(e,t,r){'use strict';eval('var _typeof=typeof Symbol==="function"&&typeof(typeof Symbol===\'function\'?Symbol.iterator:\'@@iterator\')==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==(typeof Symbol===\'function\'?Symbol.prototype:\'@@prototype\')?"symbol":typeof obj;};var d=__webpack_require__(/*! d */ "./node_modules/d/index.js"),callable=__webpack_require__(/*! es5-ext/object/valid-callable */ "./node_modules/es5-ext/object/valid-callable.js"),apply=Function.prototype.apply,call=Function.prototype.call,create=Object.create,defineProperty=Object.defineProperty,defineProperties=Object.defineProperties,hasOwnProperty=Object.prototype.hasOwnProperty,descriptor={configurable:true,enumerable:false,writable:true},on,_once2,off,emit,methods,descriptors,base;on=function on(type,listener){var data;callable(listener);if(!hasOwnProperty.call(this,\'__ee__\')){data=descriptor.value=create(null);defineProperty(this,\'__ee__\',descriptor);descriptor.value=null;}else{data=this.__ee__;}if(!data[type])data[type]=listener;else if(_typeof(data[type])===\'object\')data[type].push(listener);else data[type]=[data[type],listener];return this;};_once2=function once(type,listener){var _once,self;callable(listener);self=this;on.call(this,type,_once=function once(){off.call(self,type,_once);apply.call(listener,this,arguments);});_once.__eeOnceListener__=listener;return this;};off=function off(type,listener){var data,listeners,candidate,i;callable(listener);if(!hasOwnProperty.call(this,\'__ee__\'))return this;data=this.__ee__;if(!data[type])return this;listeners=data[type];if((typeof listeners===\'undefined\'?\'undefined\':_typeof(listeners))===\'object\'){for(i=0;candidate=listeners[i];++i){if(candidate===listener||candidate.__eeOnceListener__===listener){if(listeners.length===2)data[type]=listeners[i?0:1];else listeners.splice(i,1);}}}else{if(listeners===listener||listeners.__eeOnceListener__===listener){delete data[type];}}return this;};emit=function emit(type){var i,l,listener,listeners,args;if(!hasOwnProperty.call(this,\'__ee__\'))return;listeners=this.__ee__[type];if(!listeners)return;if((typeof listeners===\'undefined\'?\'undefined\':_typeof(listeners))===\'object\'){l=arguments.length;args=new Array(l-1);for(i=1;i<l;++i){args[i-1]=arguments[i];}listeners=listeners.slice();for(i=0;listener=listeners[i];++i){apply.call(listener,this,args);}}else{switch(arguments.length){case 1:call.call(listeners,this);break;case 2:call.call(listeners,this,arguments[1]);break;case 3:call.call(listeners,this,arguments[1],arguments[2]);break;default:l=arguments.length;args=new Array(l-1);for(i=1;i<l;++i){args[i-1]=arguments[i];}apply.call(listeners,this,args);}}};methods={on:on,once:_once2,off:off,emit:emit};descriptors={on:d(on),once:d(_once2),off:d(off),emit:d(emit)};base=defineProperties({},descriptors);module.exports=exports=function exports(o){return o==null?create(base):defineProperties(Object(o),descriptors);};exports.methods=methods;\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/event-emitter/index.js?')},"./node_modules/path-webpack/path.js":function(e,t,r){'use strict';eval('var _typeof=typeof Symbol==="function"&&typeof(typeof Symbol===\'function\'?Symbol.iterator:\'@@iterator\')==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==(typeof Symbol===\'function\'?Symbol.prototype:\'@@prototype\')?"symbol":typeof obj;};if(!process){var process={"cwd":function cwd(){return\'/\';}};}function assertPath(path){if(typeof path!==\'string\'){throw new TypeError(\'Path must be a string. Received \'+path);}}function normalizeStringPosix(path,allowAboveRoot){var res=\'\';var lastSlash=-1;var dots=0;var code;for(var i=0;i<=path.length;++i){if(i<path.length)code=path.charCodeAt(i);else if(code===47)break;else code=47;if(code===47){if(lastSlash===i-1||dots===1){}else if(lastSlash!==i-1&&dots===2){if(res.length<2||res.charCodeAt(res.length-1)!==46||res.charCodeAt(res.length-2)!==46){if(res.length>2){var start=res.length-1;var j=start;for(;j>=0;--j){if(res.charCodeAt(j)===47)break;}if(j!==start){if(j===-1)res=\'\';else res=res.slice(0,j);lastSlash=i;dots=0;continue;}}else if(res.length===2||res.length===1){res=\'\';lastSlash=i;dots=0;continue;}}if(allowAboveRoot){if(res.length>0)res+=\'/..\';else res=\'..\';}}else{if(res.length>0)res+=\'/\'+path.slice(lastSlash+1,i);else res=path.slice(lastSlash+1,i);}lastSlash=i;dots=0;}else if(code===46&&dots!==-1){++dots;}else{dots=-1;}}return res;}function _format(sep,pathObject){var dir=pathObject.dir||pathObject.root;var base=pathObject.base||(pathObject.name||\'\')+(pathObject.ext||\'\');if(!dir){return base;}if(dir===pathObject.root){return dir+base;}return dir+sep+base;}var posix={resolve:function resolve(){var resolvedPath=\'\';var resolvedAbsolute=false;var cwd;for(var i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path;if(i>=0)path=arguments[i];else{if(cwd===undefined)cwd=process.cwd();path=cwd;}assertPath(path);if(path.length===0){continue;}resolvedPath=path+\'/\'+resolvedPath;resolvedAbsolute=path.charCodeAt(0)===47;}resolvedPath=normalizeStringPosix(resolvedPath,!resolvedAbsolute);if(resolvedAbsolute){if(resolvedPath.length>0)return\'/\'+resolvedPath;else return\'/\';}else if(resolvedPath.length>0){return resolvedPath;}else{return\'.\';}},normalize:function normalize(path){assertPath(path);if(path.length===0)return\'.\';var isAbsolute=path.charCodeAt(0)===47;var trailingSeparator=path.charCodeAt(path.length-1)===47;path=normalizeStringPosix(path,!isAbsolute);if(path.length===0&&!isAbsolute)path=\'.\';if(path.length>0&&trailingSeparator)path+=\'/\';if(isAbsolute)return\'/\'+path;return path;},isAbsolute:function isAbsolute(path){assertPath(path);return path.length>0&&path.charCodeAt(0)===47;},join:function join(){if(arguments.length===0)return\'.\';var joined;for(var i=0;i<arguments.length;++i){var arg=arguments[i];assertPath(arg);if(arg.length>0){if(joined===undefined)joined=arg;else joined+=\'/\'+arg;}}if(joined===undefined)return\'.\';return posix.normalize(joined);},relative:function relative(from,to){assertPath(from);assertPath(to);if(from===to)return\'\';from=posix.resolve(from);to=posix.resolve(to);if(from===to)return\'\';var fromStart=1;for(;fromStart<from.length;++fromStart){if(from.charCodeAt(fromStart)!==47)break;}var fromEnd=from.length;var fromLen=fromEnd-fromStart;var toStart=1;for(;toStart<to.length;++toStart){if(to.charCodeAt(toStart)!==47)break;}var toEnd=to.length;var toLen=toEnd-toStart;var length=fromLen<toLen?fromLen:toLen;var lastCommonSep=-1;var i=0;for(;i<=length;++i){if(i===length){if(toLen>length){if(to.charCodeAt(toStart+i)===47){return to.slice(toStart+i+1);}else if(i===0){return to.slice(toStart+i);}}else if(fromLen>length){if(from.charCodeAt(fromStart+i)===47){lastCommonSep=i;}else if(i===0){lastCommonSep=0;}}break;}var fromCode=from.charCodeAt(fromStart+i);var toCode=to.charCodeAt(toStart+i);if(fromCode!==toCode)break;else if(fromCode===47)lastCommonSep=i;}var out=\'\';for(i=fromStart+lastCommonSep+1;i<=fromEnd;++i){if(i===fromEnd||from.charCodeAt(i)===47){if(out.length===0)out+=\'..\';else out+=\'/..\';}}if(out.length>0)return out+to.slice(toStart+lastCommonSep);else{toStart+=lastCommonSep;if(to.charCodeAt(toStart)===47)++toStart;return to.slice(toStart);}},_makeLong:function _makeLong(path){return path;},dirname:function dirname(path){assertPath(path);if(path.length===0)return\'.\';var code=path.charCodeAt(0);var hasRoot=code===47;var end=-1;var matchedSlash=true;for(var i=path.length-1;i>=1;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){end=i;break;}}else{matchedSlash=false;}}if(end===-1)return hasRoot?\'/\':\'.\';if(hasRoot&&end===1)return\'//\';return path.slice(0,end);},basename:function basename(path,ext){if(ext!==undefined&&typeof ext!==\'string\')throw new TypeError(\'"ext" argument must be a string\');assertPath(path);var start=0;var end=-1;var matchedSlash=true;var i;if(ext!==undefined&&ext.length>0&&ext.length<=path.length){if(ext.length===path.length&&ext===path)return\'\';var extIdx=ext.length-1;var firstNonSlashEnd=-1;for(i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){start=i+1;break;}}else{if(firstNonSlashEnd===-1){matchedSlash=false;firstNonSlashEnd=i+1;}if(extIdx>=0){if(code===ext.charCodeAt(extIdx)){if(--extIdx===-1){end=i;}}else{extIdx=-1;end=firstNonSlashEnd;}}}}if(start===end)end=firstNonSlashEnd;else if(end===-1)end=path.length;return path.slice(start,end);}else{for(i=path.length-1;i>=0;--i){if(path.charCodeAt(i)===47){if(!matchedSlash){start=i+1;break;}}else if(end===-1){matchedSlash=false;end=i+1;}}if(end===-1)return\'\';return path.slice(start,end);}},extname:function extname(path){assertPath(path);var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var preDotState=0;for(var i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break;}continue;}if(end===-1){matchedSlash=false;end=i+1;}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1;}else if(startDot!==-1){preDotState=-1;}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){return\'\';}return path.slice(startDot,end);},format:function format(pathObject){if(pathObject===null||(typeof pathObject===\'undefined\'?\'undefined\':_typeof(pathObject))!==\'object\'){throw new TypeError(\'Parameter "pathObject" must be an object, not \'+(typeof pathObject===\'undefined\'?\'undefined\':_typeof(pathObject)));}return _format(\'/\',pathObject);},parse:function parse(path){assertPath(path);var ret={root:\'\',dir:\'\',base:\'\',ext:\'\',name:\'\'};if(path.length===0)return ret;var code=path.charCodeAt(0);var isAbsolute=code===47;var start;if(isAbsolute){ret.root=\'/\';start=1;}else{start=0;}var startDot=-1;var startPart=0;var end=-1;var matchedSlash=true;var i=path.length-1;var preDotState=0;for(;i>=start;--i){code=path.charCodeAt(i);if(code===47){if(!matchedSlash){startPart=i+1;break;}continue;}if(end===-1){matchedSlash=false;end=i+1;}if(code===46){if(startDot===-1)startDot=i;else if(preDotState!==1)preDotState=1;}else if(startDot!==-1){preDotState=-1;}}if(startDot===-1||end===-1||preDotState===0||preDotState===1&&startDot===end-1&&startDot===startPart+1){if(end!==-1){if(startPart===0&&isAbsolute)ret.base=ret.name=path.slice(1,end);else ret.base=ret.name=path.slice(startPart,end);}}else{if(startPart===0&&isAbsolute){ret.name=path.slice(1,startDot);ret.base=path.slice(1,end);}else{ret.name=path.slice(startPart,startDot);ret.base=path.slice(startPart,end);}ret.ext=path.slice(startDot,end);}if(startPart>0)ret.dir=path.slice(0,startPart-1);else if(isAbsolute)ret.dir=\'/\';return ret;},sep:\'/\',delimiter:\':\',posix:null};module.exports=posix;\n\n//# sourceURL=webpack://EPUBJSContents/./node_modules/path-webpack/path.js?')},xmldom:function(e,t){eval('module.exports = __WEBPACK_EXTERNAL_MODULE_xmldom__;\n\n//# sourceURL=webpack://EPUBJSContents/external_%22xmldom%22?')}})});